

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimized Minecraft World Example</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@3f0df33946cf12e3d552b3b4e500dd5b8ff6f692/dist/aframe-master.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
    <script src="./dist/minecraft-world.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        #gameCanvas { width: 100%; height: 100%; }
        #debug { position: absolute; top: 0; left: 0; background: rgba(0,0,0,0.5); color: white; padding: 10px; }
    </style>
</head>
<body>
    <a-scene id="scene">
        <a-entity id="rig" movement-controls wasd-controls="acceleration:10" position="0 50 0">
            <a-entity id="player" wasd camera look-controls ></a-entity>
        </a-entity>
        
    </a-scene>
    <div id="debug"></div>
    <script>
        // Wait for A-Frame to load
              // Wait for A-Frame to load
        $(function(){
            const debugElement = document.getElementById('debug');

            // Initialize the Minecraft world
            const world = new MinecraftWorld.default({
                chunkSize: 16,
                worldHeight: 256,
                renderDistance: 4,
                seed: Math.random()
            });

            // Get the A-Frame scene
            const aframeScene = document.querySelector('a-scene');

            // Wait for the camera to be set up
            aframeScene.addEventListener('camera-set-active', function () {
                // Get the Three.js scene and camera
                const scene = aframeScene.object3D;
                const camera = document.querySelector('#player').getObject3D('camera');

                // Initialize the world
                world.init(scene, camera);

                // Add some basic block types
                world.addBlockType({
                name: 'GRASS',
                material: { color: '#3cba54' }
            });
            world.addBlockType({
                name: 'DIRT',
                material: { color: '#795548' }
            });
            world.addBlockType({
                name: 'STONE',
                material: { color: '#9e9e9e' }
            });
            world.addBlockType({
                name: 'WATER',
                material: { color: '#2196f3', opacity: 0.8 }
            });
            world.addBlockType({
                name: 'SAND',
                material: { color: '#fdd835' }
            });
            world.addBlockType({
                name: 'SNOW',
                material: { color: '#ffffff' }
            });

            world.addBlockType({
                name: 'IRON_ORE',
                material: { src: 'assets/block_textures/IRON_ORE.png' }
            });

            world.addBlockType({
                name: 'GOLD_ORE',
                material: { src: 'assets/block_textures/GOLD_ORE.png' }
            });

            world.addBlockType({
                name: 'DIAMOND_ORE',
                material: { src: 'assets/block_textures/DIAMOND_ORE.png' }
            });

            world.addBlockType({
                name: 'LAVA',
                material: { src: 'assets/block_textures/LAVA_TEXTURE.png' }
            });

            world.addBlockType({
                name: 'STALACTITE',
                material: { src: 'assets/block_textures/STALACTITE_TEXTURE.png' }
            });

                // Force initial chunk generation
                world.updatePlayerPosition(0, 100, 0);

                // Set up game loop
                function gameLoop() {
                    requestAnimationFrame(gameLoop);

                    // Update player position
                    const playerEl = document.querySelector('#rig');
                    const position = playerEl.getAttribute('position');
                    world.updatePlayerPosition(position.x, position.y, position.z);
                    console.log('updating');
                    // Update the world
                    world.update();

                    // Update debug info
                    debugElement.innerHTML = `
                        Player Position: (${position.x.toFixed(2)}, ${position.y.toFixed(2)}, ${position.z.toFixed(2)})<br>
                    `;
                }

                // Start the game loop
                gameLoop();

                // Optional: Add some interactivity
                document.addEventListener('keydown', function(event) {
                    const playerEl = document.querySelector('#rig');
                    const position = playerEl.getAttribute('position');
                    
                    if (event.key === 'e') {
                        // Place a block
                        world.setBlock(Math.floor(position.x), Math.floor(position.y) - 1, Math.floor(position.z), 'STONE');
                    } else if (event.key === 'q') {
                        // Remove a block
                        world.setBlock(Math.floor(position.x), Math.floor(position.y) - 1, Math.floor(position.z), 'AIR');
                    }
                });
            });
        });
    
    </script>
</body>
</html>